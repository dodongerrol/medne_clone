<div billing-payments-directive>
	<p class="page-title font-helvetica-medium">
		Billing & Payments
	</p>
	<div class="grid grid-cols-1 gap-8">
		<information></information>
		<contacts></contacts>
		<costcentre></costcentre>

		<div class="billing-payments">

			<section class="invoices flex-1 mb-4">
				<div class="dropdown flex-1">
					<p class="ui-label-lg font-helvetica-medium">Invoices</p>
					<div class="dropdown_wrapper">
						<!-- <div x-data="{ open: false }">
							<button @click="open = true" class="dropdown_button">
								<span  ng-bind='invoiceSelectorValue'></span>
								<img src="../../assets/hr-dashboard/img/alpine-down-arrow.svg" alt="">
							</button>
							<ul x-show="open" @click.away="open = false">
								<li ng-click="invoiceSelector(invoiceSelectorValue)">Spendings</li>
								<li ng-click="invoiceSelector(invoiceSelectorValue)">Prepaid Credits Invoice</li>
								<li>Plan</li>
								<li>Refund</li>
								<li>Deposit</li>
							</ul>
						</div> -->
						<select ng-change="invoiceSelector( invoiceSelectorValue )" ng-model="invoiceSelectorValue">
							<option value="spending">Spendings</option>
              <option value="spending_purchase">Prepaid Credits Invoice</option>
              <option value="plan">Plan</option>
              <option value="plan_withdrawal">Refund</option>
              <option value="deposit">Deposit</option>
						</select>
					</div>
				</div>

				<div class="total-outstanding" ng-class="{'red-border': billingPagination.total_due == 0}">
					<p class="main-text">Total Outstanding</p>
					<div class="flex justify-center currrency-wrapper">
						<p class="currency">{{ currencyType }}</p>&nbsp;
						<p class="amount">{{ totalOutstanding }}</p>
					</div>
				</div>
			</section>

			<section class="main-section">
				<div class="table-header flex">
					<p>Status</p>
					<p>Invoice Number</p>
					<p>Invoice Date</p>
					<p>Amount Due</p>
					<p>Panel/Non-Panel</p>
					<p>Download</p>
				</div>

				<div x-data="{ open: false }" class="table-content" ng-repeat="list in billingData">

					<div class="content-details">

						<div class="status-container">
							<div ng-if="list.status == 0">
								<button @click="open = true" class="status-container-btn">
									<img x-show='open'  src="../../assets/hr-dashboard/img/blue-angle-up.svg" alt="" class="arrow-icon">
									<img x-show='!open' src="../../assets/hr-dashboard/img/blue-angle-down.svg" alt="" class="arrow-icon">
								</button>
								<button class="content-btn btn-pending">Pending</button>
							</div>
							<div ng-if="list.status == 1">
								<button @click="open = true" class="status-container-btn" ng-click="alpineButton(list.id)">
									<img x-show='open' src="../../assets/hr-dashboard/img/blue-angle-up.svg" alt="" class="arrow-icon">
									<img x-show='!open' src="../../assets/hr-dashboard/img/blue-angle-down.svg" alt="" class="arrow-icon">
								</button>
								<button class="content-btn btn-paid">Paid</button>
							</div>
						</div>

						<p ng-bind="list.number">000238283</p>
						<p ng-bind="list.invoice_date">01 Feb 2020</p>
						<p><span ng-bind="list.currency_type"></span>&nbsp;<span ng-bind="list.amount_due"></span></p>
						<p>
							<span ng-if="list.type == 'panel'">Mednefits Panel</span>
							<span ng-if="list.type == 'non_panel'">Non-Panel</span>
						</p>
						<div class="download-container">
							<div class="content-dropdown">
								<div x-data="{ open: false }">
									<button @click="open = true" class="">
										<p><img src="../../assets/hr-dashboard/img/action-dots.png" alt="" class="dots-icon"></p>
									</button>
									<ul x-show="open" @click.away="open = false">
										<li ng-disabled="!list.isEnableInvoices" ng-click="downloadViewInvoice(list.id)">Invoice</li>
										<li ng-disabled="!list.isEnableInvoices" ng-if="list.category_type == 'spending'" ng-click="downloadViewTransactions(list.id, list.type)">Transaction History</li>
									</ul>
								</div>
							</div>
						</div>
					</div>

					<ul x-show="open" @click.away="open = false">
						<div class="amount-payment-wrapper">
							<div class="amount-payment pending flex">
								<div class="flex">
									<p>Amount Due:</p>	
									<span><span ng-bind="list.currency_type"></span>&nbsp;<span ng-bind="list.amount_due"></span></span>
								</div>
								<div class="flex">
									<p>Payment Due:</p>
									<span ng-bind="list.payment_due"></span>
								</div>
							</div>
						</div>
						<div class="amount-payment-wrapper">
							<div class="amount-payment paid flex">
								<div class="flex">
									<p>Amount Paid:</p>
									<span><span ng-bind="list.currency_type"></span>&nbsp;<span ng-bind="list.payment_amount"></span></span>
								</div>
								<div class="flex">
									<p>Payment Date:</p>
									<span ng-bind="list.payment_due"></span>
								</div>
							</div>
							<div class="content-remarks">
								<p>Remarks:</p>
								<span ng-bind="payment_remarks"></span>
							</div>
					</ul>

				</div>
			</section>
			<div class="custom-pagination-container flex-1">
				<div class="custom-pagination">
					<div class="page-wrapper">
						<div class="page-scroll-container">

							<span ng-click="_prevPageList_()" class="prev-next-container" ng-class="{'prev-disabled' :  page_active <= 1}">  
								<i class="fa fa-angle-left"></i> 
								<span>Prev</span>
							</span>

							<div class="pages-list">
									
								<!-- <span class="page-num active">1</span>	 -->
								<span ng-repeat="list in range( billingPagination.last_page ) " ng-bind="list + 1" class="page-num" ng-click="_selectNumList_(list + 1)" ng-class="{'active' : list + 1 == page_active}">1</span>

								 <!-- <span style="flex: initial;" ng-if="global_memberOpenedPagination.last_page > 10 && open_page_active < ( global_memberOpenedPagination.last_page - 5 )" ng-click="_selectNumList_('open',global_memberOpenedPagination.last_page)" >.. {{ global_memberOpenedPagination.last_page }}</span> -->
								
							</div>
							<span ng-click="_nextPageList_()" class="prev-next-container" ng-class="{'prev-disabled' :  billingPagination.last_page <= billingPagination.current_page}">  
								<span>Next</span>
								<i class="fa fa-angle-right"></i> 
							</span>
						</div>
					</div>

					<!-- <div ng-click="_toggleOpenPerPage_()" class="custom-list-per-page"> -->
					<!-- <div ng-click="_toggleOpenPerPage_()" ng-if="global_memberOpenedPagination.next_page_url" class="custom-list-per-page"> -->
						<!-- <span><span>{{ per_page }}</span> per page</span>
						<span>  
							<i class="fa fa-caret-down"></i>
						</span>
						<div ng-if="billing_pagination_dropdown" class="opened-per-page-scroll">
							<span ng-click="_setPageLimit_( 5 )">5 per page</span>
							<span ng-click="_setPageLimit_( 10 )">10 per page</span>
							<span ng-click="_setPageLimit_( 20 )">20 per page</span>
							<span ng-click="_setPageLimit_( 50 )">50 per page</span>
							<span ng-click="_setPageLimit_( 100 )">100 per page</span>
						</div>
					</div> -->

					<div x-data="{ open: false }" class="alpine-container">
						<button @click="open = true">
							<span>{{ per_page }}</span> per page &nbsp;
							<i class="fa fa-sort-desc" aria-hidden="true"></i>
						</button>
						<ul x-show="open" @click.away="open = false">
							<span @click="open = false" ng-click="_setPageLimit_( 5 )">5 per page</span>
							<span @click="open = false" ng-click="_setPageLimit_( 10 )">10 per page</span>
							<span @click="open = false" ng-click="_setPageLimit_( 20 )">20 per page</span>
							<span @click="open = false" ng-click="_setPageLimit_( 50 )">50 per page</span>
							<span @click="open = false" ng-click="_setPageLimit_( 100 )">100 per page</span>
						</ul>
				</div>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade administrator-modal-container" id="permission-modal" tabindex="-1" role= "dialog">
    <div ng-if="true" class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5>Permission Denied</h5>
        </div>
        <div class="modal-body">
          <img src="../assets/hr-dashboard/img/close-circular-button-symbol.png">
          <div>
            <div>Sorry! You have no permission to <span ng-if="get_permissions_data.manage_billing_and_payments == 0">manage billing and payments.</span></div>
          </div>
        </div>
        <div class="modal-footer">
          <button data-dismiss="modal" class="btn-update btn-close">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>


<style scoped>
	@import url('../../../../../../assets/hr-dashboard/templates/home/companyProfile/BillingPayments/style.css');
</style>